<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê—Ä–æ–º–∞-–ö–≤–µ—Å—Ç | –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏</title>
    <style>
        :root {
            --primary-yellow: #FFD700;
            --primary-black: #1a1a1a;
            --primary-gray: #f5f5f5;
            --primary-red: #e74c3c;
            --primary-green: #2ecc71;
            --primary-purple: #9b59b6;
            --primary-blue: #3498db;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --glow: 0 0 15px rgba(255, 215, 0, 0.5);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--primary-black);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .logo {
            font-size: 2.5em;
            font-weight: bold;
            color: var(--primary-yellow);
            text-shadow: var(--glow);
            margin-bottom: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .subtitle {
            font-size: 1.2em;
            color: white;
            margin-top: 10px;
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .tab-btn {
            padding: 10px 25px;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 30px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }

        .tab-btn:hover, .tab-btn.active {
            background: var(--primary-yellow);
            color: var(--primary-black);
            transform: translateY(-2px);
        }

        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }

        @media (max-width: 968px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .quests-section, .profile-section, .calendar-section, .leaderboard-section {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            display: none;
        }

        .quests-section.active, .profile-section.active, .calendar-section.active, .leaderboard-section.active {
            display: block;
        }

        .quests-section:hover, .profile-section:hover, .calendar-section:hover, .leaderboard-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .section-title {
            color: var(--primary-black);
            margin-bottom: 20px;
            font-size: 1.8em;
            text-align: center;
            position: relative;
            padding-bottom: 10px;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: var(--primary-yellow);
            border-radius: 3px;
        }

        .quest-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 15px;
            color: white;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .quest-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            transition: var(--transition);
        }

        .quest-card:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }

        .quest-card:hover::before {
            left: 100%;
        }

        .quest-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .quest-title {
            font-size: 1.3em;
            font-weight: bold;
        }

        .quest-type {
            background: rgba(255,255,255,0.2);
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .quest-desc {
            font-size: 0.95em;
            margin-bottom: 15px;
            opacity: 0.9;
            line-height: 1.5;
        }

        .quest-progress {
            margin-bottom: 10px;
        }

        .quest-progress-bar {
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }

        .quest-progress-fill {
            height: 100%;
            background: var(--primary-yellow);
            transition: width 0.3s ease;
        }

        .quest-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9em;
        }

        .quest-reward {
            background: var(--primary-yellow);
            color: var(--primary-black);
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .quest-status {
            display: inline-block;
            margin-left: 15px;
            font-size: 0.85em;
            padding: 3px 10px;
            border-radius: 15px;
            font-weight: bold;
        }

        .status-available {
            background: var(--primary-green);
            color: white;
        }

        .status-completed {
            background: #95a5a6;
            color: white;
        }

        .status-locked {
            background: #34495e;
            color: white;
        }

        .status-cooldown {
            background: var(--primary-blue);
            color: white;
        }

        .cooldown-timer {
            font-size: 0.8em;
            color: rgba(255,255,255,0.7);
            margin-top: 5px;
        }

        .profile-info {
            text-align: center;
            margin-bottom: 25px;
        }

        .avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-yellow), #ffd700);
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3.5em;
            color: var(--primary-black);
            box-shadow: var(--glow);
            animation: rotate 3s linear infinite;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .avatar::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes shine {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }

        .avatar:hover {
            transform: scale(1.1) rotate(360deg);
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.8);
        }

        .user-name {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--primary-black);
        }

        .user-level {
            color: var(--primary-gray);
            font-size: 1em;
            background: linear-gradient(90deg, var(--primary-yellow), #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: bold;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: var(--primary-gray);
            padding: 15px;
            border-radius: var(--border-radius);
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,215,0,0.1), transparent);
            opacity: 0;
            transition: var(--transition);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-card:hover {
            background: var(--primary-yellow);
            transform: translateY(-3px);
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: var(--primary-black);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.85em;
            color: var(--primary-black);
            opacity: 0.7;
        }

        .progress-container {
            margin-bottom: 25px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9em;
            color: var(--primary-black);
            font-weight: bold;
        }

        .progress-bar {
            height: 30px;
            background: var(--primary-gray);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            border: 2px solid var(--primary-yellow);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-yellow), #ffd700);
            border-radius: 15px;
            transition: width 0.5s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shine 2s infinite;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--primary-black);
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.5);
        }

        .rewards-section {
            margin-top: 25px;
        }

        .reward-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: var(--border-radius);
            padding: 15px;
            margin-bottom: 10px;
            color: white;
            transition: var(--transition);
            position: relative;
            cursor: pointer;
        }

        .reward-card:hover {
            transform: translateX(10px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .reward-card.claimed {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            cursor: not-allowed;
            opacity: 0.7;
        }

        .reward-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .reward-title {
            font-weight: bold;
            font-size: 1.1em;
        }

        .reward-points {
            background: rgba(255,255,255,0.3);
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.9em;
        }

        .reward-desc {
            font-size: 0.85em;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .reward-code {
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 5px;
            font-family: monospace;
            margin-top: 5px;
            display: inline-block;
            font-weight: bold;
            letter-spacing: 2px;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary-green);
            color: white;
            padding: 15px 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 1000;
            animation: slideIn 0.3s ease forwards;
        }

        @keyframes slideIn {
            to { transform: translateX(0); }
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: var(--primary-red);
        }

        .notification.warning {
            background: var(--primary-yellow);
            color: var(--primary-black);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            max-width: 600px;
            width: 90%;
            animation: modalOpen 0.3s ease;
            position: relative;
            max-height: 80vh;
            overflow-y: auto;
        }

        @keyframes modalOpen {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.5em;
            cursor: pointer;
            color: var(--primary-gray);
            transition: var(--transition);
        }

        .close-modal:hover {
            color: var(--primary-red);
            transform: rotate(90deg);
        }

        .modal-title {
            font-size: 1.8em;
            margin-bottom: 20px;
            color: var(--primary-black);
            text-align: center;
            border-bottom: 2px solid var(--primary-yellow);
            padding-bottom: 15px;
        }

        .modal-desc {
            margin-bottom: 20px;
            line-height: 1.6;
            color: var(--primary-black);
        }

        .mini-game {
            background: var(--primary-gray);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            text-align: center;
        }

        .memory-game {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            max-width: 400px;
            margin: 0 auto;
        }

        .memory-card {
            width: 60px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary-yellow), #ffd700);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            cursor: pointer;
            transition: var(--transition);
            color: var(--primary-black);
            box-shadow: var(--shadow);
        }

        .memory-card.flipped {
            transform: rotateY(180deg);
            background: white;
        }

        .memory-card.matched {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .quiz-question {
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--primary-black);
        }

        .quiz-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .quiz-option {
            padding: 12px;
            background: var(--primary-gray);
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            text-align: left;
            color: var(--primary-black);
        }

        .quiz-option:hover {
            background: var(--primary-yellow);
            border-color: var(--primary-yellow);
        }

        .quiz-option.selected {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        .quiz-option.correct {
            background: var(--primary-green);
            color: white;
            border-color: var(--primary-green);
        }

        .quiz-option.incorrect {
            background: var(--primary-red);
            color: white;
            border-color: var(--primary-red);
        }

        .typing-game {
            text-align: center;
            margin: 20px 0;
        }

        .word-to-type {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--primary-black);
            letter-spacing: 2px;
        }

        .typing-input {
            padding: 12px;
            font-size: 1.2em;
            border: 2px solid var(--primary-yellow);
            border-radius: 8px;
            text-align: center;
            width: 80%;
            margin: 0 auto;
            display: block;
            color: var(--primary-black);
        }

        .typing-input:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .modal-actions {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
            flex: 1;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-yellow), #ffd700);
            color: var(--primary-black);
        }

        .btn-secondary {
            background: var(--primary-gray);
            color: var(--primary-black);
        }

        .btn-success {
            background: var(--primary-green);
            color: white;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            margin-top: 15px;
        }

        .calendar-header {
            text-align: center;
            font-weight: bold;
            padding: 8px;
            color: var(--primary-black);
            font-size: 0.9em;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            font-size: 0.9em;
            color: var(--primary-black);
        }

        .calendar-day:hover {
            background: var(--primary-yellow);
            transform: scale(1.1);
        }

        .calendar-day.today {
            background: var(--primary-yellow);
            color: var(--primary-black);
            font-weight: bold;
            box-shadow: var(--glow);
        }

        .calendar-day.past {
            opacity: 0.6;
        }

        .calendar-day.future {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .calendar-day.completed {
            background: var(--primary-green);
            color: white;
        }

        .calendar-day.missed {
            background: var(--primary-red);
            color: white;
        }

        .day-number {
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 0.7em;
            font-weight: bold;
        }

        .day-reward {
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7em;
            font-weight: bold;
            color: var(--primary-yellow);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .leaderboard-list {
            list-style: none;
        }

        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: var(--primary-gray);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .leaderboard-item:hover {
            background: var(--primary-yellow);
        }

        .leaderboard-item.current {
            background: linear-gradient(135deg, var(--primary-yellow), #ffd700);
            color: var(--primary-black);
            font-weight: bold;
            box-shadow: var(--glow);
        }

        .leaderboard-rank {
            font-weight: bold;
            font-size: 1.2em;
            min-width: 30px;
            text-align: center;
        }

        .leaderboard-name {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .leaderboard-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary-yellow);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--primary-black);
        }

        .leaderboard-points {
            font-weight: bold;
            color: var(--primary-yellow);
        }

        footer {
            text-align: center;
            margin-top: 30px;
            color: white;
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* Dark theme */
        body.dark-theme {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
        }

        body.dark-theme .quests-section,
        body.dark-theme .profile-section,
        body.dark-theme .calendar-section,
        body.dark-theme .leaderboard-section {
            background: #2c3e50;
            color: white;
        }

        body.dark-theme .section-title {
            color: white;
        }

        body.dark-theme .section-title::after {
            background: var(--primary-yellow);
        }

        body.dark-theme .stat-card {
            background: #34495e;
            color: white;
        }

        body.dark-theme .user-name,
        body.dark-theme .stat-value,
        body.dark-theme .stat-label {
            color: white;
        }

        body.dark-theme .progress-bar {
            background: #34495e;
        }

        body.dark-theme .reward-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        body.dark-theme .quiz-option {
            color: white;
        }

        body.dark-theme .typing-input {
            color: white;
            background: #34495e;
        }

        body.dark-theme .calendar-day {
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">‚ú® –ê—Ä–æ–º–∞-–ö–≤–µ—Å—Ç ‚ú®</div>
            <div class="subtitle">–û—Ç–∫—Ä–æ–π—Ç–µ –º–∏—Ä —ç—Ñ–∏—Ä–Ω—ã—Ö –º–∞—Å–µ–ª –∏ –ø–æ–ª—É—á–∏—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –±–æ–Ω—É—Å—ã!</div>
            <div class="tabs">
                <button class="tab-btn active" data-tab="quests">üéØ –ö–≤–µ—Å—Ç—ã</button>
                <button class="tab-btn" data-tab="profile">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>
                <button class="tab-btn" data-tab="calendar">üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å</button>
                <button class="tab-btn" data-tab="leaderboard">üèÜ –†–µ–π—Ç–∏–Ω–≥–∏</button>
            </div>
        </header>

        <div class="main-content">
            <div class="quests-section active">
                <h2 class="section-title">–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–≤–µ—Å—Ç—ã</h2>
                <div id="questsContainer"></div>
            </div>

            <div class="profile-section">
                <h2 class="section-title">–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å</h2>
                <div class="profile-info">
                    <div class="avatar" id="avatar">üë§</div>
                    <div class="user-name" id="userName">–ü—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫</div>
                    <div class="user-level">–£—Ä–æ–≤–µ–Ω—å: <span id="userLevel">1</span></div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="points">0</div>
                        <div class="stat-label">–ë–∞–ª–ª–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="completed">0</div>
                        <div class="stat-label">–ö–≤–µ—Å—Ç–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="streak">0</div>
                        <div class="stat-label">–î–Ω–µ–π –ø–æ–¥—Ä—è–¥</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="discount">0%</div>
                        <div class="stat-label">–°–∫–∏–¥–∫–∞</div>
                    </div>
                </div>

                <div class="progress-container">
                    <div class="progress-label">
                        <span>–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è</span>
                        <span id="progressText">0/1000</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%">
                            <div class="progress-text" id="progressPercent">0%</div>
                        </div>
                    </div>
                </div>

                <div class="rewards-section">
                    <h3 style="margin-bottom: 15px; color: var(--primary-black);">–í–∞—à–∏ –ø—Ä–æ–º–æ–∫–æ–¥—ã:</h3>
                    <div id="rewardsContainer"></div>
                </div>
            </div>

            <div class="calendar-section">
                <h2 class="section-title">–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–¥–∞–Ω–∏–π</h2>
                <p style="text-align: center; margin-bottom: 20px; color: var(--primary-black);">
                    –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ –ø–æ–ª–Ω–æ—á—å. –ù–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–µ!
                </p>
                <div class="calendar" id="calendar"></div>
                <div style="margin-top: 20px; padding: 15px; background: var(--primary-gray); border-radius: var(--border-radius);">
                    <p style="color: var(--primary-black); font-weight: bold;">
                        üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–µ—Å—è—Ü–∞:
                    </p>
                    <p id="calendarStats" style="color: var(--primary-black); margin-top: 10px;"></p>
                </div>
            </div>

            <div class="leaderboard-section">
                <h2 class="section-title">–¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h2>
                <p style="text-align: center; margin-bottom: 20px; color: var(--primary-black);">
                    –°–æ—Ä–µ–≤–Ω—É–π—Ç–µ—Å—å —Å –¥—Ä—É–≥–∏–º–∏ –∞—Ä–æ–º–∞-–ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º–∏!
                </p>
                <ul class="leaderboard-list" id="leaderboard"></ul>
            </div>
        </div>

        <footer>
            <p>–ê—Ä–æ–º–∞-–ö–≤–µ—Å—Ç ¬© 2026 | –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–π –∫–æ—Å–º–µ—Ç–∏–∫–∏</p>
            <p style="margin-top: 5px; font-size: 0.8em;">–í–∞—à–∏ –±–æ–Ω—É—Å—ã –¥–µ–π—Å—Ç–≤—É—é—Ç –≤ –Ω–∞—à–µ–º –æ–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω–µ –∞—Ä–æ–º–∞—Ç–æ–≤ –∏ –∫–æ—Å–º–µ—Ç–∏–∫–∏</p>
        </footer>
    </div>

    <div class="notification" id="notification"></div>

    <div class="modal" id="questModal">
        <div class="modal-content">
            <span class="close-modal" id="closeModal">&times;</span>
            <h3 class="modal-title" id="modalTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–≤–µ—Å—Ç–∞</h3>
            <p class="modal-desc" id="modalDesc">–û–ø–∏—Å–∞–Ω–∏–µ –∫–≤–µ—Å—Ç–∞...</p>
            <div id="questContent"></div>
            <div class="modal-actions">
                <button class="btn btn-secondary" id="declineBtn">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-primary" id="actionBtn">–ù–∞—á–∞—Ç—å –∑–∞–¥–∞–Ω–∏–µ</button>
            </div>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const appData = {
            user: {
                id: generateUserId(),
                name: '–ü—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫',
                level: 1,
                points: 0,
                completedQuests: 0,
                streakDays: 0,
                lastLogin: null,
                avatar: 'üë§',
                dailyLogin: null,
                weeklyReset: null,
                achievements: []
            },
            quests: [
                {
                    id: 1,
                    title: '–ò–∑—É—á–µ–Ω–∏–µ –ª–∞–≤–∞–Ω–¥—ã',
                    description: '–õ–∞–≤–∞–Ω–¥–∞ - –∫–æ—Ä–æ–ª–µ–≤–∞ —ç—Ñ–∏—Ä–Ω—ã—Ö –º–∞—Å–µ–ª. –ü—Ä–æ–π–¥–∏—Ç–µ —Ç–µ—Å—Ç –∏ —É–∑–Ω–∞–π—Ç–µ –µ—ë —Å–≤–æ–π—Å—Ç–≤–∞.',
                    reward: 50,
                    status: 'available',
                    type: 'daily',
                    difficulty: 'easy',
                    cooldown: 86400000, // 24 —á–∞—Å–∞
                    lastCompleted: null,
                    gameType: 'quiz',
                    gameData: {
                        question: '–ö–∞–∫–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –ª–∞–≤–∞–Ω–¥—ã –Ω–∞–∏–±–æ–ª–µ–µ –∏–∑–≤–µ—Å—Ç–Ω–æ?',
                        options: [
                            { text: '–ê–Ω—Ç–∏–±–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–µ', correct: false },
                            { text: '–£—Å–ø–æ–∫–∞–∏–≤–∞—é—â–µ–µ', correct: true },
                            { text: '–û—Ç–±–µ–ª–∏–≤–∞—é—â–µ–µ', correct: false },
                            { text: '–°–æ–≥—Ä–µ–≤–∞—é—â–µ–µ', correct: false }
                        ]
                    }
                },
                {
                    id: 2,
                    title: '–ó–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∞—Ä–æ–º–∞—Ç–æ–≤',
                    description: '–ó–∞–ø–æ–º–Ω–∏—Ç–µ –ø–∞—Ä—ã —ç—Ñ–∏—Ä–Ω—ã—Ö –º–∞—Å–µ–ª. –¢—Ä–µ–Ω–∏—Ä—É–π—Ç–µ –ø–∞–º—è—Ç—å –∏ —É–∑–Ω–∞–≤–∞–π—Ç–µ –Ω–æ–≤—ã–µ –∞—Ä–æ–º–∞—Ç—ã!',
                    reward: 75,
                    status: 'available',
                    type: 'daily',
                    difficulty: 'medium',
                    cooldown: 86400000,
                    lastCompleted: null,
                    gameType: 'memory',
                    gameData: {
                        pairs: [
                            { emoji: 'üåø', name: '–†–æ–∑–º–∞—Ä–∏–Ω' },
                            { emoji: 'üå∏', name: '–†–æ–∑–∞' },
                            { emoji: 'üçã', name: '–õ–∏–º–æ–Ω' },
                            { emoji: 'üçä', name: '–ê–ø–µ–ª—å—Å–∏–Ω' },
                            { emoji: 'üå≤', name: '–ü–∏—Ö—Ç–∞' },
                            { emoji: 'üå∫', name: '–ò–ª–∞–Ω–≥-–∏–ª–∞–Ω–≥' },
                            { emoji: 'üå±', name: '–ú—è—Ç–∞' },
                            { emoji: 'üåº', name: '–†–æ–º–∞—à–∫–∞' }
                        ]
                    }
                },
                {
                    id: 3,
                    title: '–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏',
                    description: '–ù–∞–ø–∏—à–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —ç—Ñ–∏—Ä–Ω–æ–≥–æ –º–∞—Å–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ –ø—Ä–∞–≤–æ–ø–∏—Å–∞–Ω–∏–µ –∏ —É–∑–Ω–∞–≤–∞–π—Ç–µ –Ω–æ–≤—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è!',
                    reward: 60,
                    status: 'available',
                    type: 'daily',
                    difficulty: 'easy',
                    cooldown: 86400000,
                    lastCompleted: null,
                    gameType: 'typing',
                    gameData: {
                        words: ['–ª–∞–≤–∞–Ω–¥–∞', '—Ä–æ–∑–º–∞—Ä–∏–Ω', '–∏–ª–∞–Ω–≥-–∏–ª–∞–Ω–≥', '—ç–≤–∫–∞–ª–∏–ø—Ç', '–±–µ—Ä–≥–∞–º–æ—Ç', '–ø–µ—Ç–∏—Ç–≥—Ä–µ–π–Ω']
                    }
                },
                {
                    id: 4,
                    title: '–≠–∫—Å–ø–µ—Ä—Ç –ø–æ —Ü–∏—Ç—Ä—É—Å–æ–≤—ã–º',
                    description: '–ü—Ä–æ–π–¥–∏—Ç–µ —Å–ª–æ–∂–Ω—ã–π —Ç–µ—Å—Ç –æ —Ü–∏—Ç—Ä—É—Å–æ–≤—ã—Ö –º–∞—Å–ª–∞—Ö –∏ —Å—Ç–∞–Ω—å—Ç–µ –Ω–∞—Å—Ç–æ—è—â–∏–º —ç–∫—Å–ø–µ—Ä—Ç–æ–º!',
                    reward: 120,
                    status: 'locked',
                    type: 'weekly',
                    difficulty: 'hard',
                    cooldown: 604800000, // 7 –¥–Ω–µ–π
                    lastCompleted: null,
                    gameType: 'quiz',
                    gameData: {
                        question: '–ö–∞–∫–æ–µ —Ü–∏—Ç—Ä—É—Å–æ–≤–æ–µ –º–∞—Å–ª–æ –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ —Å–æ–ª–Ω—Ü–µ?',
                        options: [
                            { text: '–ê–ø–µ–ª—å—Å–∏–Ω', correct: false },
                            { text: '–õ–∏–º–æ–Ω', correct: true },
                            { text: '–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç', correct: false },
                            { text: '–ú–∞–Ω–¥–∞—Ä–∏–Ω', correct: false }
                        ]
                    },
                    unlockRequirement: { level: 2 }
                },
                {
                    id: 5,
                    title: '–ú–∞—Å—Ç–µ—Ä —Å–º–µ—à–∏–≤–∞–Ω–∏—è',
                    description: '–ó–∞–ø–æ–º–Ω–∏—Ç–µ 10 –ø–∞—Ä —ç—Ñ–∏—Ä–Ω—ã—Ö –º–∞—Å–µ–ª –∏ –∏—Ö —Å–≤–æ–π—Å—Ç–≤. –¢–æ–ª—å–∫–æ –¥–ª—è –Ω–∞—Å—Ç–æ—è—â–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤!',
                    reward: 200,
                    status: 'locked',
                    type: 'weekly',
                    difficulty: 'hard',
                    cooldown: 604800000,
                    lastCompleted: null,
                    gameType: 'memory',
                    gameData: {
                        pairs: [
                            { emoji: 'üåø', name: '–†–æ–∑–º–∞—Ä–∏–Ω - –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è' },
                            { emoji: 'üå∏', name: '–†–æ–∑–∞ - –ª—é–±–æ–≤—å' },
                            { emoji: 'üçã', name: '–õ–∏–º–æ–Ω - —ç–Ω–µ—Ä–≥–∏—è' },
                            { emoji: 'üçä', name: '–ê–ø–µ–ª—å—Å–∏–Ω - —Ä–∞–¥–æ—Å—Ç—å' },
                            { emoji: 'üå≤', name: '–ü–∏—Ö—Ç–∞ - —Å–∏–ª–∞' },
                            { emoji: 'üå∫', name: '–ò–ª–∞–Ω–≥-–∏–ª–∞–Ω–≥ - —Å—Ç—Ä–∞—Å—Ç—å' },
                            { emoji: 'üå±', name: '–ú—è—Ç–∞ - —Å–≤–µ–∂–µ—Å—Ç—å' },
                            { emoji: 'üåº', name: '–†–æ–º–∞—à–∫–∞ - —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ' },
                            { emoji: 'üíß', name: '–õ–∞–≤–∞–Ω–¥–∞ - —Å–æ–Ω' },
                            { emoji: '‚òÄÔ∏è', name: '–ë–µ—Ä–≥–∞–º–æ—Ç - –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ' }
                        ]
                    },
                    unlockRequirement: { completedQuests: 5 }
                },
                {
                    id: 6,
                    title: '–ê—Ä–æ–º–∞—Ç–µ—Ä–∞–ø–∏—è –¥–ª—è —Å–Ω–∞',
                    description: '–ù–∞–ø–∏—à–∏—Ç–µ 5 –Ω–∞–∑–≤–∞–Ω–∏–π –º–∞—Å–µ–ª –¥–ª—è —Å–Ω–∞ –±–µ–∑ –æ—à–∏–±–æ–∫.',
                    reward: 100,
                    status: 'locked',
                    type: 'weekly',
                    difficulty: 'medium',
                    cooldown: 604800000,
                    lastCompleted: null,
                    gameType: 'typing',
                    gameData: {
                        words: ['–ª–∞–≤–∞–Ω–¥–∞', '—Ä–æ–º–∞—à–∫–∞', '–∏–ª–∞–Ω–≥-–∏–ª–∞–Ω–≥', '—Å–∞–Ω–¥–∞–ª', '–Ω–µ—Ä–æ–ª–∏']
                    },
                    unlockRequirement: { streakDays: 3 }
                },
                {
                    id: 7,
                    title: '–ò—Å—Ç–æ—Ä–∏—è —ç—Ñ–∏—Ä–Ω—ã—Ö –º–∞—Å–µ–ª',
                    description: '–£–∑–Ω–∞–π—Ç–µ –∏—Å—Ç–æ—Ä–∏—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ñ–∏—Ä–Ω—ã—Ö –º–∞—Å–µ–ª –≤ –¥—Ä–µ–≤–Ω–æ—Å—Ç–∏.',
                    reward: 80,
                    status: 'available',
                    type: 'daily',
                    difficulty: 'medium',
                    cooldown: 86400000,
                    lastCompleted: null,
                    gameType: 'quiz',
                    gameData: {
                        question: '–í –∫–∞–∫–æ–π –¥—Ä–µ–≤–Ω–µ–π —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–∏ –≤–ø–µ—Ä–≤—ã–µ –Ω–∞—á–∞–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ñ–∏—Ä–Ω—ã–µ –º–∞—Å–ª–∞?',
                        options: [
                            { text: '–î—Ä–µ–≤–Ω–∏–π –ï–≥–∏–ø–µ—Ç', correct: true },
                            { text: '–î—Ä–µ–≤–Ω—è—è –ì—Ä–µ—Ü–∏—è', correct: false },
                            { text: '–î—Ä–µ–≤–Ω–∏–π –†–∏–º', correct: false },
                            { text: '–í–∞–≤–∏–ª–æ–Ω', correct: false }
                        ]
                    }
                },
                {
                    id: 8,
                    title: '–ë–æ—Ç–∞–Ω–∏—á–µ—Å–∫–∏–π —Å–∞–¥',
                    description: '–ó–∞–ø–æ–º–Ω–∏—Ç–µ —Ä–∞—Å—Ç–µ–Ω–∏—è, –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –¥–æ–±—ã–≤–∞—é—Ç —ç—Ñ–∏—Ä–Ω—ã–µ –º–∞—Å–ª–∞.',
                    reward: 90,
                    status: 'locked',
                    type: 'weekly',
                    difficulty: 'medium',
                    cooldown: 604800000,
                    lastCompleted: null,
                    gameType: 'memory',
                    gameData: {
                        pairs: [
                            { emoji: 'üåπ', name: '–†–æ–∑–∞' },
                            { emoji: 'üåº', name: '–†–æ–º–∞—à–∫–∞' },
                            { emoji: 'üåø', name: '–õ–∞–≤–∞–Ω–¥–∞' },
                            { emoji: 'üå±', name: '–ú—è—Ç–∞' },
                            { emoji: 'üçã', name: '–õ–∏–º–æ–Ω' },
                            { emoji: 'üçä', name: '–ê–ø–µ–ª—å—Å–∏–Ω' },
                            { emoji: 'üå≤', name: '–ü–∏—Ö—Ç–∞' },
                            { emoji: 'üå∏', name: '–ñ–∞—Å–º–∏–Ω' }
                        ]
                    },
                    unlockRequirement: { level: 3 }
                }
            ],
            rewards: [
                {
                    id: 1,
                    title: '–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –±–æ–Ω—É—Å',
                    description: '–°–∫–∏–¥–∫–∞ 5% –Ω–∞ –ø–µ—Ä–≤—É—é –ø–æ–∫—É–ø–∫—É',
                    code: 'WELCOME5',
                    pointsRequired: 100,
                    claimed: false
                },
                {
                    id: 2,
                    title: '–ë–æ–Ω—É—Å –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é',
                    description: '–°–∫–∏–¥–∫–∞ 10% –Ω–∞ –ª—é–±—É—é –ø–æ–∫—É–ø–∫—É',
                    code: 'AROMA10',
                    pointsRequired: 250,
                    claimed: false
                },
                {
                    id: 3,
                    title: '–ü—Ä–µ–º–∏—É–º —Å–∫–∏–¥–∫–∞',
                    description: '–°–∫–∏–¥–∫–∞ 15% –Ω–∞ –∑–∞–∫–∞–∑ –æ—Ç 3000‚ÇΩ',
                    code: 'PREMIUM15',
                    pointsRequired: 500,
                    claimed: false
                },
                {
                    id: 4,
                    title: '–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ',
                    description: '–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ + —Å–∫–∏–¥–∫–∞ 20%',
                    code: 'VIP20',
                    pointsRequired: 1000,
                    claimed: false
                },
                {
                    id: 5,
                    title: '–ú–∞—Å—Ç–µ—Ä –∞—Ä–æ–º–∞—Ç–æ–≤',
                    description: '–°–∫–∏–¥–∫–∞ 25% –Ω–∞ –≤–µ—Å—å –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç',
                    code: 'MASTER25',
                    pointsRequired: 2000,
                    claimed: false
                }
            ],
            dailyTasks: [],
            leaderboard: []
        };

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const elements = {
            questsContainer: document.getElementById('questsContainer'),
            points: document.getElementById('points'),
            completed: document.getElementById('completed'),
            streak: document.getElementById('streak'),
            discount: document.getElementById('discount'),
            userLevel: document.getElementById('userLevel'),
            userName: document.getElementById('userName'),
            progressFill: document.getElementById('progressFill'),
            progressText: document.getElementById('progressText'),
            progressPercent: document.getElementById('progressPercent'),
            rewardsContainer: document.getElementById('rewardsContainer'),
            notification: document.getElementById('notification'),
            questModal: document.getElementById('questModal'),
            modalTitle: document.getElementById('modalTitle'),
            modalDesc: document.getElementById('modalDesc'),
            questContent: document.getElementById('questContent'),
            actionBtn: document.getElementById('actionBtn'),
            declineBtn: document.getElementById('declineBtn'),
            closeModal: document.getElementById('closeModal'),
            avatar: document.getElementById('avatar'),
            calendar: document.getElementById('calendar'),
            calendarStats: document.getElementById('calendarStats'),
            leaderboard: document.getElementById('leaderboard'),
            tabBtns: document.querySelectorAll('.tab-btn')
        };

        let currentQuest = null;
        let gameInstance = null;
        let dailyResetTimer = null;

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function generateUserId() {
            return 'user_' + Math.random().toString(36).substr(2, 9);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function init() {
            loadUserData();
            checkDailyStreak();
            checkQuestCooldowns();
            generateDailyTasks();
            updateLeaderboard();
            renderQuests();
            renderRewards();
            renderCalendar();
            updateUI();
            setupEventListeners();
            setupDailyReset();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loadUserData() {
            const savedData = localStorage.getItem('aromaQuestData');
            if (savedData) {
                try {
                    const parsedData = JSON.parse(savedData);
                    appData.user = {...appData.user, ...parsedData.user};
                    appData.quests = parsedData.quests || appData.quests;
                    appData.rewards = parsedData.rewards || appData.rewards;
                    appData.dailyTasks = parsedData.dailyTasks || [];
                    appData.leaderboard = parsedData.leaderboard || appData.leaderboard;
                } catch (e) {
                    console.error('Error loading data:', e);
                }
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –≤—Ö–æ–¥–∞
        function checkDailyStreak() {
            const today = new Date().toDateString();
            const lastLogin = appData.user.lastLogin;
            
            if (!lastLogin) {
                appData.user.streakDays = 1;
                showNotification('üéØ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –ù–∞—á–Ω–∏—Ç–µ —Å–≤–æ—ë –∞—Ä–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ!', 'success');
            } else {
                const lastDate = new Date(lastLogin).toDateString();
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                yesterday.setHours(0, 0, 0, 0);
                
                const lastLoginDate = new Date(lastLogin);
                lastLoginDate.setHours(0, 0, 0, 0);
                
                if (lastLoginDate.getTime() === yesterday.getTime()) {
                    appData.user.streakDays++;
                    showNotification(`üî• –û—Ç–ª–∏—á–Ω–æ! ${appData.user.streakDays} –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥! +20 –±–æ–Ω—É—Å–Ω—ã—Ö –±–∞–ª–ª–æ–≤!`, 'success');
                    appData.user.points += 20;
                } else if (lastLoginDate.getTime() !== new Date().setHours(0, 0, 0, 0)) {
                    if (appData.user.streakDays > 1) {
                        showNotification(`‚ö†Ô∏è –°–µ—Ä–∏—è –ø—Ä–µ—Ä–≤–∞–Ω–∞. –ù–∞—á–Ω–∏—Ç–µ –∑–∞–Ω–æ–≤–æ!`, 'warning');
                    }
                    appData.user.streakDays = 1;
                }
            }
            
            appData.user.lastLogin = new Date().toISOString();
            saveUserData();
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—É–ª–¥–∞—É–Ω–∞ –∫–≤–µ—Å—Ç–æ–≤
        function checkQuestCooldowns() {
            const now = Date.now();
            
            appData.quests.forEach(quest => {
                if (quest.lastCompleted && quest.cooldown) {
                    const timeSinceCompletion = now - new Date(quest.lastCompleted).getTime();
                    
                    if (timeSinceCompletion < quest.cooldown) {
                        quest.status = 'cooldown';
                    } else if (quest.status === 'cooldown') {
                        quest.status = 'available';
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
                if (quest.status === 'locked' && quest.unlockRequirement) {
                    if (quest.unlockRequirement.level && appData.user.level >= quest.unlockRequirement.level) {
                        quest.status = 'available';
                    } else if (quest.unlockRequirement.completedQuests && appData.user.completedQuests >= quest.unlockRequirement.completedQuests) {
                        quest.status = 'available';
                    } else if (quest.unlockRequirement.streakDays && appData.user.streakDays >= quest.unlockRequirement.streakDays) {
                        quest.status = 'available';
                    }
                }
            });
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
        function generateDailyTasks() {
            const today = new Date().toDateString();
            
            if (appData.user.dailyLogin !== today) {
                appData.user.dailyLogin = today;
                
                // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–¥–∞–Ω–∏–π
                appData.dailyTasks = [];
                
                // –í—ã–±–æ—Ä 3 —Å–ª—É—á–∞–π–Ω—ã—Ö –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –∫–≤–µ—Å—Ç–æ–≤
                const dailyQuests = appData.quests
                    .filter(q => q.type === 'daily' && q.status === 'available')
                    .sort(() => 0.5 - Math.random())
                    .slice(0, 3);
                
                dailyQuests.forEach(quest => {
                    appData.dailyTasks.push({
                        questId: quest.id,
                        available: true
                    });
                });
                
                saveUserData();
            }
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function saveUserData() {
            localStorage.setItem('aromaQuestData', JSON.stringify({
                user: appData.user,
                quests: appData.quests,
                rewards: appData.rewards,
                dailyTasks: appData.dailyTasks,
                leaderboard: appData.leaderboard
            }));
        }

        // –†–µ–Ω–¥–µ—Ä –∫–≤–µ—Å—Ç–æ–≤
        function renderQuests() {
            elements.questsContainer.innerHTML = '';
            
            // –°–Ω–∞—á–∞–ª–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è
            if (appData.dailyTasks.length > 0) {
                const dailySection = document.createElement('div');
                dailySection.innerHTML = '<h3 style="color: var(--primary-black); margin-bottom: 15px; border-left: 4px solid var(--primary-yellow); padding-left: 10px;">üìÖ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</h3>';
                elements.questsContainer.appendChild(dailySection);
                
                appData.dailyTasks.forEach(task => {
                    const quest = appData.quests.find(q => q.id === task.questId);
                    if (quest && task.available) {
                        renderQuestCard(quest, dailySection);
                    }
                });
            }
            
            // –ü–æ—Ç–æ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–≤–µ—Å—Ç—ã
            const otherSection = document.createElement('div');
            otherSection.innerHTML = '<h3 style="color: var(--primary-black); margin: 20px 0 15px 0; border-left: 4px solid var(--primary-blue); padding-left: 10px;">üèÜ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã</h3>';
            elements.questsContainer.appendChild(otherSection);
            
            appData.quests
                .filter(q => !appData.dailyTasks.some(t => t.questId === q.id))
                .forEach(quest => {
                    if (quest.status === 'locked' && !canUnlockQuest(quest)) return;
                    renderQuestCard(quest, otherSection);
                });
        }

        // –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–≤–µ—Å—Ç–∞
        function renderQuestCard(quest, container) {
            const questCard = document.createElement('div');
            questCard.className = 'quest-card';
            
            let statusText = '';
            let statusClass = '';
            let cooldownText = '';
            
            if (quest.status === 'available') {
                statusText = '–î–æ—Å—Ç—É–ø–µ–Ω';
                statusClass = 'status-available';
            } else if (quest.status === 'completed') {
                statusText = '–ó–∞–≤–µ—Ä—à–µ–Ω';
                statusClass = 'status-completed';
            } else if (quest.status === 'locked') {
                statusText = '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω';
                statusClass = 'status-locked';
            } else if (quest.status === 'cooldown') {
                statusText = '–ü–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞';
                statusClass = 'status-cooldown';
                
                if (quest.lastCompleted && quest.cooldown) {
                    const remaining = quest.cooldown - (Date.now() - new Date(quest.lastCompleted).getTime());
                    if (remaining > 0) {
                        const hours = Math.floor(remaining / 3600000);
                        const minutes = Math.floor((remaining % 3600000) / 60000);
                        cooldownText = `<div class="cooldown-timer">‚è±Ô∏è –û—Å—Ç–∞–ª–æ—Å—å: ${hours}—á ${minutes}–º</div>`;
                    }
                }
            }
            
            questCard.innerHTML = `
                <div class="quest-header">
                    <div class="quest-title">${quest.title}</div>
                    <div class="quest-type">${getDifficultyIcon(quest.difficulty)} ${quest.type === 'daily' ? '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π' : '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π'}</div>
                </div>
                <div class="quest-desc">${quest.description}</div>
                <div class="quest-footer">
                    <span class="quest-reward">+${quest.reward} –±–∞–ª–ª–æ–≤</span>
                    <span class="quest-status ${statusClass}">${statusText}</span>
                </div>
                ${cooldownText}
            `;
            
            if (quest.status === 'available') {
                questCard.addEventListener('click', () => showQuestModal(quest));
            } else if (quest.status === 'locked') {
                questCard.title = getUnlockRequirementText(quest);
            }
            
            container.appendChild(questCard);
        }

        // –ü–æ–ª—É—á–∏—Ç—å –∏–∫–æ–Ω–∫—É —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
        function getDifficultyIcon(difficulty) {
            switch(difficulty) {
                case 'easy': return 'üü¢';
                case 'medium': return 'üü°';
                case 'hard': return 'üî¥';
                default: return '‚ö™';
            }
        }

        // –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
        function getUnlockRequirementText(quest) {
            if (!quest.unlockRequirement) return '';
            
            if (quest.unlockRequirement.level) {
                return `–¢—Ä–µ–±—É–µ—Ç—Å—è —É—Ä–æ–≤–µ–Ω—å ${quest.unlockRequirement.level}`;
            } else if (quest.unlockRequirement.completedQuests) {
                return `–¢—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à–∏—Ç—å ${quest.unlockRequirement.completedQuests} –∫–≤–µ—Å—Ç–æ–≤`;
            } else if (quest.unlockRequirement.streakDays) {
                return `–¢—Ä–µ–±—É–µ—Ç—Å—è —Å–µ—Ä–∏—è –∏–∑ ${quest.unlockRequirement.streakDays} –¥–Ω–µ–π`;
            }
            
            return '–¢—Ä–µ–±—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∑–∞–¥–∞–Ω–∏—è';
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–≤–µ—Å—Ç
        function canUnlockQuest(quest) {
            if (!quest.unlockRequirement) return false;
            
            if (quest.unlockRequirement.level && appData.user.level >= quest.unlockRequirement.level) {
                return true;
            }
            if (quest.unlockRequirement.completedQuests && appData.user.completedQuests >= quest.unlockRequirement.completedQuests) {
                return true;
            }
            if (quest.unlockRequirement.streakDays && appData.user.streakDays >= quest.unlockRequirement.streakDays) {
                return true;
            }
            
            return false;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–≤–µ—Å—Ç–∞
        function showQuestModal(quest) {
            currentQuest = quest;
            elements.modalTitle.textContent = quest.title;
            elements.modalDesc.textContent = quest.description;
            
            // –°–æ–∑–¥–∞–µ–º –∏–≥—Ä—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
            createGameInstance(quest);
            
            elements.questModal.style.display = 'flex';
        }

        // –°–æ–∑–¥–∞—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å –∏–≥—Ä—ã
        function createGameInstance(quest) {
            elements.questContent.innerHTML = '';
            
            switch(quest.gameType) {
                case 'quiz':
                    createQuizGame(quest.gameData);
                    break;
                case 'memory':
                    createMemoryGame(quest.gameData);
                    break;
                case 'typing':
                    createTypingGame(quest.gameData);
                    break;
            }
        }

        // –°–æ–∑–¥–∞—Ç—å –≤–∏–∫—Ç–æ—Ä–∏–Ω—É
        function createQuizGame(gameData) {
            const quizDiv = document.createElement('div');
            quizDiv.className = 'mini-game';
            quizDiv.innerHTML = `
                <div class="quiz-question">${gameData.question}</div>
                <div class="quiz-options" id="quizOptions"></div>
            `;
            
            elements.questContent.appendChild(quizDiv);
            
            const optionsDiv = document.getElementById('quizOptions');
            let selectedOption = null;
            
            gameData.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'quiz-option';
                optionDiv.textContent = option.text;
                optionDiv.dataset.index = index;
                
                optionDiv.addEventListener('click', () => {
                    if (selectedOption !== null) return;
                    
                    selectedOption = index;
                    optionDiv.className = 'quiz-option selected';
                    
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞
                    setTimeout(() => {
                        if (option.correct) {
                            optionDiv.className = 'quiz-option correct';
                            elements.actionBtn.textContent = '–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É';
                            elements.actionBtn.disabled = false;
                            elements.actionBtn.onclick = () => completeQuest(currentQuest.id);
                        } else {
                            optionDiv.className = 'quiz-option incorrect';
                            showNotification('‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑.', 'error');
                            elements.actionBtn.textContent = '–ó–∞–∫—Ä—ã—Ç—å';
                            elements.actionBtn.onclick = () => elements.questModal.style.display = 'none';
                        }
                    }, 1000);
                });
                
                optionsDiv.appendChild(optionDiv);
            });
            
            elements.actionBtn.disabled = true;
        }

        // –°–æ–∑–¥–∞—Ç—å –∏–≥—Ä—É –Ω–∞ –ø–∞–º—è—Ç—å
        function createMemoryGame(gameData) {
            const memoryDiv = document.createElement('div');
            memoryDiv.className = 'mini-game';
            memoryDiv.innerHTML = `
                <p style="margin-bottom: 15px; color: var(--primary-black);">–ù–∞–π–¥–∏—Ç–µ –≤—Å–µ –ø–∞—Ä—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫!</p>
                <div class="memory-game" id="memoryGrid"></div>
                <p id="memoryStatus" style="margin-top: 15px; color: var(--primary-black); font-weight: bold;">–û—Å—Ç–∞–ª–æ—Å—å –ø–∞—Ä: ${gameData.pairs.length}</p>
            `;
            
            elements.questContent.appendChild(memoryDiv);
            
            const grid = document.getElementById('memoryGrid');
            const status = document.getElementById('memoryStatus');
            const pairs = [...gameData.pairs, ...gameData.pairs].sort(() => 0.5 - Math.random());
            
            let flippedCards = [];
            let matchedPairs = 0;
            let lockBoard = false;
            
            pairs.forEach((pair, index) => {
                const card = document.createElement('div');
                card.className = 'memory-card';
                card.dataset.index = index;
                card.dataset.value = pair.emoji;
                
                card.addEventListener('click', () => {
                    if (lockBoard || flippedCards.includes(card) || card.className.includes('matched')) return;
                    
                    card.className = 'memory-card flipped';
                    card.textContent = pair.emoji;
                    flippedCards.push(card);
                    
                    if (flippedCards.length === 2) {
                        lockBoard = true;
                        
                        if (flippedCards[0].dataset.value === flippedCards[1].dataset.value) {
                            // –ù–∞—à–ª–∏ –ø–∞—Ä—É
                            flippedCards.forEach(c => c.className = 'memory-card matched');
                            matchedPairs++;
                            status.textContent = `–û—Å—Ç–∞–ª–æ—Å—å –ø–∞—Ä: ${gameData.pairs.length - matchedPairs}`;
                            
                            flippedCards = [];
                            lockBoard = false;
                            
                            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
                            if (matchedPairs === gameData.pairs.length) {
                                setTimeout(() => {
                                    showNotification('üéâ –û—Ç–ª–∏—á–Ω–æ! –í—Å–µ –ø–∞—Ä—ã –Ω–∞–π–¥–µ–Ω—ã!', 'success');
                                    elements.actionBtn.textContent = '–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É';
                                    elements.actionBtn.disabled = false;
                                    elements.actionBtn.onclick = () => completeQuest(currentQuest.id);
                                }, 1000);
                            }
                        } else {
                            // –ù–µ –Ω–∞—à–ª–∏ –ø–∞—Ä—É
                            setTimeout(() => {
                                flippedCards.forEach(c => {
                                    c.className = 'memory-card';
                                    c.textContent = '';
                                });
                                flippedCards = [];
                                lockBoard = false;
                            }, 1000);
                        }
                    }
                });
                
                grid.appendChild(card);
            });
            
            elements.actionBtn.disabled = true;
        }

        // –°–æ–∑–¥–∞—Ç—å –∏–≥—Ä—É –Ω–∞ –ø–µ—á–∞—Ç–∞–Ω–∏–µ
        function createTypingGame(gameData) {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'mini-game typing-game';
            
            const currentWordIndex = { value: 0 };
            const words = [...gameData.words];
            
            function showNextWord() {
                if (currentWordIndex.value >= words.length) {
                    showNotification('üéâ –û—Ç–ª–∏—á–Ω–æ! –í—Å–µ —Å–ª–æ–≤–∞ –Ω–∞–ø–∏—Å–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ!', 'success');
                    elements.actionBtn.textContent = '–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É';
                    elements.actionBtn.disabled = false;
                    elements.actionBtn.onclick = () => completeQuest(currentQuest.id);
                    return;
                }
                
                typingDiv.innerHTML = `
                    <div class="word-to-type">${words[currentWordIndex.value]}</div>
                    <input type="text" class="typing-input" id="typingInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–ª–æ–≤–æ..." autocomplete="off">
                    <p id="typingStatus" style="margin-top: 10px; color: var(--primary-black);">–°–ª–æ–≤–æ ${currentWordIndex.value + 1} –∏–∑ ${words.length}</p>
                `;
                
                const input = document.getElementById('typingInput');
                const status = document.getElementById('typingStatus');
                
                input.focus();
                
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        const answer = input.value.trim().toLowerCase();
                        const correct = words[currentWordIndex.value].toLowerCase();
                        
                        if (answer === correct) {
                            status.textContent = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!';
                            status.style.color = 'var(--primary-green)';
                            
                            setTimeout(() => {
                                currentWordIndex.value++;
                                showNextWord();
                            }, 800);
                        } else {
                            status.textContent = '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑';
                            status.style.color = 'var(--primary-red)';
                            input.value = '';
                            input.focus();
                        }
                    }
                });
            }
            
            elements.questContent.appendChild(typingDiv);
            showNextWord();
            
            elements.actionBtn.disabled = true;
        }

        // –ó–∞–≤–µ—Ä—à–∏—Ç—å –∫–≤–µ—Å—Ç
        function completeQuest(questId) {
            const quest = appData.quests.find(q => q.id === questId);
            if (!quest || quest.status !== 'available') return;
            
            // –ù–∞—á–∏—Å–ª—è–µ–º –±–∞–ª–ª—ã
            appData.user.points += quest.reward;
            appData.user.completedQuests++;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–≤–µ—Å—Ç–∞
            quest.status = 'completed';
            quest.lastCompleted = new Date().toISOString();
            
            // –ï—Å–ª–∏ —ç—Ç–æ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ, –ø–æ–º–µ—á–∞–µ–º –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ
            const dailyTask = appData.dailyTasks.find(t => t.questId === questId);
            if (dailyTask) {
                dailyTask.available = false;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Ä–æ–≤–µ–Ω—å
            checkLevelUp();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
            saveUserData();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateUI();
            renderQuests();
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            elements.questModal.style.display = 'none';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification(`üèÜ –ö–≤–µ—Å—Ç "${quest.title}" –∑–∞–≤–µ—Ä—à–µ–Ω! +${quest.reward} –±–∞–ª–ª–æ–≤`, 'success');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ª–∏–¥–µ—Ä–±–æ—Ä–¥
            updateLeaderboard();
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
        function checkLevelUp() {
            const pointsForNextLevel = appData.user.level * 1000;
            if (appData.user.points >= pointsForNextLevel) {
                appData.user.level++;
                showNotification(`üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ ${appData.user.level} —É—Ä–æ–≤–Ω—è!`, 'success');
            }
        }

        // –†–µ–Ω–¥–µ—Ä –Ω–∞–≥—Ä–∞–¥
        function renderRewards() {
            elements.rewardsContainer.innerHTML = '';
            
            appData.rewards.forEach(reward => {
                if (reward.claimed) return;
                
                const canClaim = appData.user.points >= reward.pointsRequired;
                const rewardCard = document.createElement('div');
                rewardCard.className = `reward-card ${canClaim ? '' : 'disabled'}`;
                rewardCard.style.opacity = canClaim ? '1' : '0.6';
                rewardCard.style.cursor = canClaim ? 'pointer' : 'not-allowed';
                
                rewardCard.innerHTML = `
                    <div class="reward-header">
                        <div class="reward-title">${reward.title}</div>
                        <div class="reward-points">${reward.pointsRequired} ü™ô</div>
                    </div>
                    <div class="reward-desc">${reward.description}</div>
                    <div class="reward-code">${reward.code}</div>
                `;
                
                if (canClaim) {
                    rewardCard.addEventListener('click', () => claimReward(reward));
                }
                
                elements.rewardsContainer.appendChild(rewardCard);
            });
        }

        // –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É
        function claimReward(reward) {
            if (appData.user.points < reward.pointsRequired) return;
            
            reward.claimed = true;
            appData.user.points -= reward.pointsRequired;
            
            saveUserData();
            renderRewards();
            updateUI();
            
            showNotification(`üéÅ –í—ã –ø–æ–ª—É—á–∏–ª–∏ –ø—Ä–æ–º–æ–∫–æ–¥: ${reward.code}`, 'success');
            showNotification('–ü—Ä–æ–º–æ–∫–æ–¥ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
            
            // –ö–æ–ø–∏—Ä—É–µ–º –ø—Ä–æ–º–æ–∫–æ–¥ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
            navigator.clipboard.writeText(reward.code).catch(err => {
                console.error('Failed to copy:', err);
            });
        }

        // –†–µ–Ω–¥–µ—Ä –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        function renderCalendar() {
            elements.calendar.innerHTML = '';
            
            // –ó–∞–≥–æ–ª–æ–≤–∫–∏ –¥–Ω–µ–π –Ω–µ–¥–µ–ª–∏
            ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'].forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-header';
                header.textContent = day;
                elements.calendar.appendChild(header);
            });
            
            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            
            // –ü–µ—Ä–≤—ã–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞
            const firstDay = new Date(currentYear, currentMonth, 1);
            const startingDay = firstDay.getDay() || 7; // –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ = 0
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Å—Ç—ã–µ –¥–Ω–∏ –¥–æ –Ω–∞—á–∞–ª–∞ –º–µ—Å—è—Ü–∞
            for (let i = 1; i < startingDay; i++) {
                const emptyDay = document.createElement('div');
                elements.calendar.appendChild(emptyDay);
            }
            
            // –î–Ω–∏ –º–µ—Å—è—Ü–∞
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dayDate = new Date(currentYear, currentMonth, day);
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                
                // –°—Ç–∏–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–Ω–µ–π
                if (dayDate.toDateString() === today.toDateString()) {
                    dayElement.className += ' today';
                } else if (dayDate < today) {
                    dayElement.className += ' past';
                } else {
                    dayElement.className += ' future';
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª–æ –ª–∏ –∑–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –≤ —ç—Ç–æ—Ç –¥–µ–Ω—å
                const dayString = dayDate.toISOString().split('T')[0];
                const taskCompleted = appData.dailyTasks.some(t => {
                    const taskDate = new Date(t.completedAt || '');
                    return taskDate.toISOString().split('T')[0] === dayString && t.completed;
                });
                
                if (taskCompleted) {
                    dayElement.className += ' completed';
                }
                
                dayElement.innerHTML = `
                    <span class="day-number">${day}</span>
                    <span class="day-reward">+20</span>
                `;
                
                elements.calendar.appendChild(dayElement);
            }
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            const completedDays = appData.dailyTasks.filter(t => t.completed).length;
            const totalDays = daysInMonth;
            elements.calendarStats.innerHTML = `
                –ó–∞–≤–µ—Ä—à–µ–Ω–æ: ${completedDays} –∏–∑ ${totalDays} –¥–Ω–µ–π<br>
                –°–µ—Ä–∏—è: ${appData.user.streakDays} –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥
            `;
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –ª–∏–¥–µ—Ä–±–æ—Ä–¥
        function updateLeaderboard() {
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const currentUser = {
                id: appData.user.id,
                name: appData.user.name,
                avatar: appData.user.avatar,
                points: appData.user.points,
                level: appData.user.level
            };
            
            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –≤ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–µ, –¥–æ–±–∞–≤–ª—è–µ–º
            const existingUserIndex = appData.leaderboard.findIndex(u => u.id === currentUser.id);
            if (existingUserIndex !== -1) {
                appData.leaderboard[existingUserIndex] = currentUser;
            } else {
                appData.leaderboard.push(currentUser);
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –±–∞–ª–ª–∞–º
            appData.leaderboard.sort((a, b) => b.points - a.points);
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–æ 10 –∏–≥—Ä–æ–∫–æ–≤
            appData.leaderboard = appData.leaderboard.slice(0, 10);
            
            renderLeaderboard();
            saveUserData();
        }

        // –†–µ–Ω–¥–µ—Ä –ª–∏–¥–µ—Ä–±–æ—Ä–¥–∞
        function renderLeaderboard() {
            elements.leaderboard.innerHTML = '';
            
            appData.leaderboard.forEach((user, index) => {
                const item = document.createElement('li');
                item.className = `leaderboard-item ${user.id === appData.user.id ? 'current' : ''}`;
                
                item.innerHTML = `
                    <div class="leaderboard-rank">${index + 1}</div>
                    <div class="leaderboard-name">
                        <div class="leaderboard-avatar">${user.avatar}</div>
                        <span>${user.name}</span>
                    </div>
                    <div class="leaderboard-points">${user.points} ü™ô (–£—Ä. ${user.level})</div>
                `;
                
                elements.leaderboard.appendChild(item);
            });
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
        function updateUI() {
            elements.points.textContent = appData.user.points;
            elements.completed.textContent = appData.user.completedQuests;
            elements.streak.textContent = appData.user.streakDays;
            elements.userLevel.textContent = appData.user.level;
            elements.userName.textContent = appData.user.name;
            elements.avatar.textContent = appData.user.avatar;
            
            // –†–∞—Å—á–µ—Ç —Å–∫–∏–¥–∫–∏
            const discount = Math.min(Math.floor(appData.user.points / 100), 30);
            elements.discount.textContent = `${discount}%`;
            
            // –ü—Ä–æ–≥—Ä–µ—Å—Å –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
            const pointsForNextLevel = appData.user.level * 1000;
            const progress = (appData.user.points / pointsForNextLevel) * 100;
            const progressPercent = Math.min(Math.floor(progress), 100);
            
            elements.progressFill.style.width = `${progressPercent}%`;
            elements.progressText.textContent = `${appData.user.points}/${pointsForNextLevel}`;
            elements.progressPercent.textContent = `${progressPercent}%`;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message, type = 'success') {
            elements.notification.textContent = message;
            elements.notification.className = `notification ${type}`;
            elements.notification.style.display = 'block';
            
            setTimeout(() => {
                elements.notification.style.display = 'none';
            }, 3000);
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞
        function setupDailyReset() {
            const now = new Date();
            const midnight = new Date();
            midnight.setHours(24, 0, 0, 0);
            const msUntilMidnight = midnight - now;
            
            dailyResetTimer = setTimeout(() => {
                resetDailyTasks();
                location.reload();
            }, msUntilMidnight);
        }

        // –°–±—Ä–æ—Å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
        function resetDailyTasks() {
            appData.dailyTasks = [];
            generateDailyTasks();
            checkQuestCooldowns();
            saveUserData();
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ö–Ω–æ–ø–∫–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            elements.declineBtn.addEventListener('click', () => {
                elements.questModal.style.display = 'none';
            });
            
            elements.closeModal.addEventListener('click', () => {
                elements.questModal.style.display = 'none';
            });
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
            window.addEventListener('click', (e) => {
                if (e.target === elements.questModal) {
                    elements.questModal.style.display = 'none';
                }
            });
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤
            elements.tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
                    elements.tabBtns.forEach(b => b.classList.remove('active'));
                    // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ —Ç–µ–∫—É—â–µ–π
                    btn.classList.add('active');
                    
                    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
                    document.querySelectorAll('.quests-section, .profile-section, .calendar-section, .leaderboard-section')
                        .forEach(section => section.classList.remove('active'));
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å–µ–∫—Ü–∏—é
                    const tabName = btn.dataset.tab;
                    document.querySelector(`.${tabName}-section`).classList.add('active');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
                    if (tabName === 'calendar') {
                        renderCalendar();
                    } else if (tabName === 'leaderboard') {
                        renderLeaderboard();
                    }
                });
            });
            
            // –°–º–µ–Ω–∞ –∞–≤–∞—Ç–∞—Ä–∞
            elements.avatar.addEventListener('click', () => {
                const emojis = ['üë§', 'üåø', 'üå∏', 'üå∫', 'üåº', 'üçÄ', 'üçÅ', 'üåπ', 'üíß', '‚ú®', 'üåü', 'üåô'];
                const currentIndex = emojis.indexOf(appData.user.avatar);
                const nextIndex = (currentIndex + 1) % emojis.length;
                appData.user.avatar = emojis[nextIndex];
                elements.avatar.textContent = appData.user.avatar;
                saveUserData();
                updateLeaderboard();
            });
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
